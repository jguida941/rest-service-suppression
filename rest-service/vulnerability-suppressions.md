# Vulnerability Suppression Documentation

## Overview

This document explains the CVE suppressions applied to the OWASP Dependency-Check scan for the CS 305 Module Six rest-service project. These suppressions are documented in `suppression.xml` and referenced in `pom.xml`.

**Important Note:** These are NOT false positives. The dependency versions in this project DO fall within the vulnerable ranges identified by each CVE. However, after security review, these specific vulnerabilities have been determined to be **not exploitable in this application's context** due to our specific runtime environment, deployment configuration, or feature usage.

---

## Application Context

- **Java Version:** JDK 1.8 (Java 8)
- **Packaging:** Executable JAR (Spring Boot default)
- **Framework:** Spring MVC (not WebFlux)
- **Deployment:** Standalone (not Cloud Foundry)

---

## Suppressed Vulnerabilities

### CVE-2022-22965 (Spring4Shell)
| | |
|---|---|
| **Severity** | CRITICAL (9.8) |
| **Affected Component** | Spring Framework 5.2.3.RELEASE |
| **Suppression Reason** | Not exploitable in this runtime environment |

The Spring4Shell exploit requires ([source](https://spring.io/security/cve-2022-22965/)):
1. JDK 9 or higher
2. WAR deployment on Apache Tomcat

This application uses:
1. JDK 8
2. Executable JAR packaging (Spring Boot default)

Per Spring's official advisory: "If the application is deployed as a Spring Boot executable jar, i.e. the default, it is not vulnerable to the exploit."

---

### CVE-2021-22118
| | |
|---|---|
| **Severity** | HIGH (7.8) |
| **Affected Component** | Spring Framework 5.2.3.RELEASE |
| **Suppression Reason** | Feature not used |

This vulnerability affects Spring WebFlux applications through temporary storage directory manipulation. Per [Spring's official advisory](https://spring.io/security/cve-2021-22118/): "Spring MVC applications are not affected by this vulnerability."

This application uses **Spring MVC only** and does not include WebFlux components.

---

### CVE-2022-22971
| | |
|---|---|
| **Severity** | MEDIUM (6.5) |
| **Affected Component** | Spring Framework 5.2.3.RELEASE |
| **Suppression Reason** | Feature not used |

Per [Spring's advisory](https://spring.io/security/cve-2022-22971/): "A Spring application with a STOMP over WebSocket endpoint is vulnerable to a denial of service attack."

This application has **no WebSocket endpoints configured**. The attack vector does not exist.

---

### CVE-2023-20873
| | |
|---|---|
| **Severity** | CRITICAL (9.8) |
| **Affected Component** | Spring Boot 2.2.4.RELEASE |
| **Suppression Reason** | Deployment environment not applicable |

Per [Spring's advisory](https://spring.io/security/cve-2023-20873/): "An application is not vulnerable if the application is not deployed to Cloud Foundry."

This application is not deployed to Cloud Foundry.

---

### CVE-2020-9488
| | |
|---|---|
| **Severity** | LOW (3.7) |
| **Affected Component** | log4j-api 2.12.1 |
| **Suppression Reason** | Component not configured |

This vulnerability affects the Log4j **SMTP appender** only, allowing MITM attacks on SMTPS connections. This application does not configure or use the SMTP appender for logging.

---

### CVE-2021-42550
| | |
|---|---|
| **Severity** | MEDIUM (6.6) |
| **Affected Component** | logback-core 1.2.3 |
| **Suppression Reason** | Requires privileged configuration access |

This vulnerability requires an attacker to have **write access to logback configuration files** to inject malicious JNDI lookups. In our deployment:
- Configuration files are bundled in the JAR
- Runtime configuration is not writable by external users

---

### CVE-2023-6378
| | |
|---|---|
| **Severity** | HIGH (7.5) |
| **Affected Component** | logback-core 1.2.3 |
| **Suppression Reason** | Component not used |

This vulnerability affects the logback **receiver component** used for remote logging. This application does not enable or configure remote logging receivers.

---

### CVE-2023-1932
| | |
|---|---|
| **Severity** | MEDIUM (6.1) |
| **Affected Component** | hibernate-validator 6.0.18.Final |
| **Suppression Reason** | Feature not used |

This vulnerability requires use of the `@SafeHtml` annotation for bean validation. Code review confirms this application **does not use `@SafeHtml` validation**.

---

### CVE-2020-10693
| | |
|---|---|
| **Severity** | MEDIUM (5.3) |
| **Affected Component** | hibernate-validator 6.0.18.Final |
| **Suppression Reason** | Feature not used |

This vulnerability allows bypassing input sanitation when user-controlled data is included in constraint violation error messages with Expression Language interpolation. This application **does not include user input in validation error messages**.

---

### CVE-2025-35036
| | |
|---|---|
| **Severity** | HIGH (7.3) |
| **Affected Component** | hibernate-validator 6.0.18.Final |
| **Suppression Reason** | Feature not used |

Similar to CVE-2020-10693, this requires user-supplied input to be interpolated in constraint violation messages. This application does not perform such interpolation.

---

### CVE-2023-35116
| | |
|---|---|
| **Severity** | MEDIUM (4.7) |
| **Affected Component** | jackson-databind 2.10.2 |
| **Suppression Reason** | Vendor disputed, not applicable |

Per [NVD](https://nvd.nist.gov/vuln/detail/cve-2023-35116): "The vendor's perspective is that this is not a valid vulnerability report, because the steps of constructing a cyclic data structure and trying to serialize it cannot be achieved by an external attacker."

This application does not construct cyclic structures from external input.

---

### CVE-2016-1000027
| | |
|---|---|
| **Severity** | CRITICAL (9.8) |
| **Affected Component** | Spring Framework 5.2.3.RELEASE |
| **Suppression Reason** | Untrusted deserialization not present |

Per [NVD](https://nvd.nist.gov/vuln/detail/cve-2016-1000027): "The vendor's position is that untrusted data is not an intended use case. The product's behavior will not be changed because some users rely on deserialization of trusted data."

Code review confirms this application:
- Does not use HttpInvoker
- Does not deserialize untrusted data
- Only accepts JSON via REST endpoints (handled by Jackson, not Java serialization)

---

## Remaining Vulnerabilities (NOT Suppressed)

The following vulnerabilities were **NOT suppressed** and represent genuine security risks that should be addressed through dependency upgrades in a production environment:

| Component | Issue | Recommendation |
|-----------|-------|----------------|
| snakeyaml 1.25 | Multiple DoS and RCE (CVE-2022-1471) | Upgrade to 2.0+ |
| jackson-databind 2.10.2 | XXE and DoS vulnerabilities | Upgrade to 2.15+ |
| bcprov-jdk15on 1.46 | Cryptographic weaknesses | Upgrade to 1.70+ or remove if unused |
| tomcat-embed 9.0.30 | Multiple vulnerabilities (47+ CVEs) | Upgrade Spring Boot |
| Spring Boot 2.2.4 | Multiple vulnerabilities | Upgrade to 2.7.x or 3.x |

---

## Verification

After adding suppressions, re-run the dependency check:

```bash
mvn dependency-check:check
```

The suppressed CVEs will show as suppressed in the report, while genuine vulnerabilities requiring remediation will still be flagged.

---

## References

- [OWASP Dependency-Check Suppression](https://jeremylong.github.io/DependencyCheck/general/suppression.html)
- [CVE-2022-22965 Spring Advisory](https://spring.io/security/cve-2022-22965/)
- [CVE-2021-22118 Spring Advisory](https://spring.io/security/cve-2021-22118/)
- [CVE-2022-22971 Spring Advisory](https://spring.io/security/cve-2022-22971/)
- [CVE-2023-20873 Spring Advisory](https://spring.io/security/cve-2023-20873/)
- [NVD Database](https://nvd.nist.gov/)